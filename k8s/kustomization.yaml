apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: selectchatgpt

resources:
  - namespace.yaml
  # NOTE: secrets.yaml은 secrets.yaml.example을 복사하여 실제 값으로 생성하세요
  # cp secrets.yaml.example secrets.yaml && vim secrets.yaml
  # - secrets.yaml

  # MongoDB
  - mongodb/pvc.yaml
  - mongodb/deployment.yaml
  - mongodb/service.yaml

  # Redis
  - redis/pvc.yaml
  - redis/deployment.yaml
  - redis/service.yaml

  # Server
  - server/configmap.yaml
  - server/deployment.yaml
  - server/service.yaml
  - server/service-metrics.yaml

  # Web
  - web/configmap.yaml
  - web/deployment.yaml
  - web/service.yaml

  # Ingress
  - ingress.yaml

# Image tags managed by GitOps CI pipeline
# CI builds image -> pushes to registry -> updates newTag -> ArgoCD syncs
images:
  - name: registry.jiun.dev/selectchatgpt-server
    newTag: "latest"
  - name: registry.jiun.dev/selectchatgpt-web
    newTag: "latest"
